name: Daily WeChat Message

on:
  schedule:
    - cron: '0 0 * * *'  # 每天UTC时间0点（北京时间8点）
  workflow_dispatch:

jobs:
  send-wechat-message:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v3
      
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.13'
        
    - name: Install dependencies
      run: pip install requests
      
    - name: Run WeChat message script
      env:
        WECHAT_APPID: ${{ secrets.WECHAT_APPID }}
        WECHAT_APPSECRET: ${{ secrets.WECHAT_APPSECRET }}
        WECHAT_TEMPLATE_ID: ${{ secrets.WECHAT_TEMPLATE_ID }}
        WECHAT_USER_ID: ${{ secrets.WECHAT_USER_ID }}
        CITY: ${{ secrets.CITY }}
        BIRTHDAY: ${{ secrets.BIRTHDAY }}
        GF_NAME: ${{ secrets.GF_NAME }}
      run: python wechat_message.py
      
    - name: Success notification
      if: success()
      run: echo "✅ 微信消息发送成功！"
      
    - name: Failure notification
      if: failure()
      run: echo "❌ 微信消息发送失败"
